<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸŒ¸ ê²Œì‹œíŒ ğŸŒ¸</title>
    <link rel="stylesheet" href="style.css"/>
  </head>
  <body>
    <div class="container">
      <div class="board-title">ğŸŒ¸ ê²Œì‹œíŒ ğŸŒ¸</div>
      <a class="btn-write" href="write.html">ê¸€ì“°ê¸°</a>

      <div class="box">
        <table>
          <thead>
            <tr>
              <th>ë²ˆí˜¸</th>
              <th>ì œëª©</th>
              <th>ì‘ì„±ì¼</th>
            </tr>
          </thead>
          <tbody id="post-body">
            <!-- JSë¡œ ì±„ì›Œì§ -->
          </tbody>
        </table>
      </div>

      <!-- ğŸ”¥ í˜ì´ì§€ë„¤ì´ì…˜ ì„¹ì…˜-->
      <div class="pagination">
        <a class="page-btn" href="page=1">1</a>
      </div>
    </div>

    <script>
      const STORAGE_KEY = 'myTablePosts';

      function loadPosts() {
        try {
          return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
        } catch (e) {
          console.error(e);
          return [];
        }
      }

      function formatDate(iso) {
        if (!iso) return '';
        const d = new Date(iso);
        const yyyy = d.getFullYear();
        const mm = String(d.getMonth() + 1).padStart(2, '0');
        const dd = String(d.getDate()).padStart(2, '0');
        return `${yyyy}-${mm}-${dd}`;
      }

      function renderList() {
        const tbody = document.getElementById('post-body');
        const posts = loadPosts().sort((a, b) => b.id - a.id); // ìµœì‹ ê¸€ ìœ„ë¡œ

        tbody.innerHTML = '';

        if (posts.length === 0) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td colspan="3">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤ ğŸŒ¸</td>`;
          tbody.appendChild(tr);
          return;
        }

        posts.forEach((post, idx) => {
          const tr = document.createElement('tr');

          // ë²ˆí˜¸: ìµœì‹  ê¸€ì´ 1ë²ˆì²˜ëŸ¼ ë³´ì´ê²Œ
          const no = posts.length - idx;

          tr.innerHTML = `
            <td>${no}</td>
            <td>
              <a href="detail.html?id=${post.id}">
                ${post.title}
              </a>
            </td>
            <td>${formatDate(post.createdAt)}</td>
          `;

          tbody.appendChild(tr);
        });
      }

      renderList();
    </script>
  </body>
</html>
